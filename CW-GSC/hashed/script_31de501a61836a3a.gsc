/***********************************************
 * Decompiled by Ate47 and Edited by SyndiShanX
 * Script: hashed\script_31de501a61836a3a.gsc
***********************************************/

#using script_12538a87a80a2978;
#using script_27347f09888ad15;
#using script_3357acf79ce92f4b;
#using script_3411bb48d41bd3b;
#using script_34ab99a4ca1a43d;
#using script_4163291d6e693552;
#using script_fec6e2b970dd864;
#using scripts\autogenerated\luielems\wz\prototype_hud;
#using scripts\core_common\ai\systems\gib;
#using scripts\core_common\animation_shared;
#using scripts\core_common\array_shared;
#using scripts\core_common\callbacks_shared;
#using scripts\core_common\clientfield_shared;
#using scripts\core_common\content_manager;
#using scripts\core_common\dynent_use;
#using scripts\core_common\flag_shared;
#using scripts\core_common\laststand_shared;
#using scripts\core_common\math_shared;
#using scripts\core_common\scene_shared;
#using scripts\core_common\scoreevents_shared;
#using scripts\core_common\struct;
#using scripts\core_common\util_shared;
#using scripts\core_common\values_shared;
#using scripts\core_common\vehicle_shared;
#using scripts\zm_common\objective_manager;
#using scripts\zm_common\zm_powerups;
#using scripts\zm_common\zm_sq;
#using scripts\zm_common\zm_stats;
#using scripts\zm_common\zm_utility;
#namespace namespace_fa1c4f0a;

function event_handler[level_init] main(eventstruct) {
  clientfield::register("scriptmover", "" + # "portal", 1, 1, "int");
  clientfield::register("scriptmover", "" + # "hash_2a7da9a87ecef87b", 1, 1, "int");
  clientfield::register("scriptmover", "" + # "payload_teleport", 1, 2, "int");
  clientfield::register("toplayer", "" + # "portal_blur", 1, 1, "int");
  clientfield::register("scriptmover", "" + # "portal_shockwave", 1, 1, "counter");
  clientfield::register("vehicle", "" + # "teleport_trail", 1, 1, "int");
  clientfield::register("vehicle", "" + # "payload_health", 1, 1, "counter");
  clientfield::register("vehicle", "" + # "payload_activate", 1, 1, "int");
  clientfield::register("vehicle", "" + # "payload_scan", 1, 1, "counter");
  clientfield::register("vehicle", "" + # "payload_running", 1, 1, "int");
  clientfield::register("vehicle", "" + # "payload_enter", 1, 1, "int");
  objective_manager::register_script(#"payload_escort", &init, &function_d137dbd4, #"payload", #"hash_6df9aea076cea4ba", #"hash_4ddf1b97bee2b93", 6, #"hash_7cd75fcb4650df62");
  callback::on_spawned(&on_player_spawned);
}

function init(instance) {
  instance thread namespace_7589cf5c::vo_start("objectivePayloadAnnounce", "objectivePayloadAnnounceResponse");

  foreach(s_instance in instance.contentgroups[#"payload"]) {
    if(isDefined(s_instance.contentgroups[#"truck"])) {
      s_instance.var_738e322b = content_manager::spawn_script_model(s_instance.contentgroups[#"truck"][0], #"veh_t9_sv_truck_hemtt_payload_delivery", 1);
    }

    wait 0.1;
    s_instance.var_b8ca9d7 = spawnvehicle(#"hash_d069dee6a0076c8", s_instance.origin, s_instance.angles, "vehicle_payload", 0, undefined, "sensor");
    s_instance.var_b8ca9d7.team = "allies";
    s_instance.var_b8ca9d7.s_portal = s_instance.contentgroups[#"portal"][0];
    s_instance.var_b8ca9d7.s_start = s_instance.contentgroups[#"payload_start"][0];
    s_instance.var_b8ca9d7.var_559503f1 = s_instance.contentgroups[#"hash_3d588f728a53044"];
    s_instance.var_b8ca9d7 vehicle::toggle_sounds(0);
    wait 1;
    s_instance.var_b8ca9d7 thread function_27033bf7(instance);
  }

  instance.var_7a9e6505 = 1;
  instance.mdl_reward = s_instance.contentgroups[#"reward_drop"][0];
  instance.var_1ac40948 = s_instance.var_738e322b;
  instance.var_b8ca9d7 = s_instance.var_b8ca9d7;
  instance.var_b8ca9d7.var_6a4ec994 = 0;
  instance.var_b8ca9d7.var_dd6fe31f = 1;
  instance.var_b8ca9d7.var_43123efe = util::spawn_model(#"c_t8_cottontop_monkey_fb1", instance.var_b8ca9d7 gettagorigin("tag_cage_attach"));
  instance.var_1cd294c7 = util::spawn_model("tag_origin", instance.var_b8ca9d7 gettagorigin("tag_cage_attach"), instance.var_b8ca9d7 gettagangles("tag_cage_attach"));

  if(isDefined(instance.var_b8ca9d7.var_43123efe) && isDefined(instance.var_1cd294c7)) {
    instance.var_1cd294c7 linkto(instance.var_b8ca9d7, "tag_cage_attach", (0, 0, 0), (0, -180, 0));
    instance.var_b8ca9d7.var_43123efe linkto(instance.var_1cd294c7);

    if(instance.var_b8ca9d7.var_6a4ec994 == 0) {
      instance thread function_98da33e1();
    }
  }

  if(isDefined(s_instance.contentgroups[#"rift"])) {
    instance.var_d4f4d124 = s_instance.contentgroups[#"rift"];
  }

  if(isDefined(instance.contentgroups[#"zombie_blocker"])) {
    instance thread function_9bf6c44a();
  }

  if(isDefined(instance.contentgroups[#"hash_17213ba6ef802c84"])) {
    instance.var_f2af10b2 = util::spawn_model(instance.contentgroups[#"hash_17213ba6ef802c84"][0].model, instance.contentgroups[#"hash_17213ba6ef802c84"][0].origin, instance.contentgroups[#"hash_17213ba6ef802c84"][0].angles);
    waitframe(1);

    if(isDefined(instance.var_f2af10b2)) {
      instance.var_f2af10b2 ghost();
    }
  }

  if(isDefined(instance.contentgroups[#"hash_53295f8e563380a6"])) {
    var_3608e7a6 = instance.contentgroups[#"hash_53295f8e563380a6"][0];
    instance.var_f2065b9e = util::spawn_model(var_3608e7a6.model, var_3608e7a6.origin, var_3608e7a6.angles);
    waitframe(1);

    if(isDefined(instance.var_f2065b9e)) {
      instance.var_f2065b9e ghost();
    }
  }

  if(isDefined(instance.contentgroups[#"collision_platform"])) {
    var_111c92a8 = content_manager::function_cfa4f1a0(instance.contentgroups[#"collision_platform"], #"hash_1435198d5240ac8c", 0);

    foreach(var_3cefdbf5 in var_111c92a8) {
      var_3cefdbf5 ghost();
    }
  }

  instance thread function_6e7546c5();
  instance thread function_f5087df2();
  instance thread function_83e5a141();
  instance thread function_5466a4e2();

  if(instance.targetname === # "hash_7d1a7cd215013b8b") {
    instance.var_b8ca9d7 thread function_753d6448(instance);
  } else if(instance.targetname === # "hash_57f0a312931f2fb8") {
    instance thread function_68ec5e25();
  } else if(instance.targetname === # "hash_57701e31cc5a9388") {
    instance thread function_81fd5bee();
  } else {
    instance.var_b8ca9d7 thread function_dcf94cdf(instance);
  }

  level.var_acd0f67e = instance.variant === "payload_teleport" ? 4 : 3;

  if(instance.variant === "payload_teleport") {
    showmiscmodels("payload_teleport_corpses");
  }

  if(instance.variant === "payload_noteleport") {
    showmiscmodels("payload_noteleport_corpses");
  }
}

function on_player_spawned() {
  if(level.contentmanager.activeobjective.content_script_name === "payload_escort") {
    level.var_31028c5d prototype_hud::set_active_objective_string(self, #"hash_838284821745ec7");
    level.var_31028c5d prototype_hud::function_817e4d10(self, 2);
    var_b8ca9d7 = level.contentmanager.activeobjective.var_b8ca9d7;

    if(!isDefined(var_b8ca9d7.n_start_health)) {
      var_c3a3ae13 = 1;
    } else {
      var_c3a3ae13 = var_b8ca9d7.health / var_b8ca9d7.n_start_health;
    }

    self zm_sq::sndonoverride_eye_(var_c3a3ae13);
    self zm_sq::function_2398ab16("objective_ended");
  }
}

function function_17f1d0f3() {
  self.var_5e36739b = self namespace_7589cf5c::function_df911075();
  self.var_61c57c53 = self namespace_7589cf5c::function_1b53cdc7();
  self.var_5de17ec9 = self namespace_7589cf5c::function_56fa33d9();
  self.var_2133c784 = 0;
  self.var_b803db9c = 0;
}

function function_eb76d765() {
  if(self.location.target === "destination_forest") {
    var_3b25dd0c = function_3236ac12();
  } else if(self.location.target === "destination_golova") {
    var_3b25dd0c = function_44b02002();
  } else if(self.location.target === "destination_sanatorium") {
    var_3b25dd0c = function_18973f36();
  } else if(self.location.target === "destination_ski") {
    var_3b25dd0c = function_7ae74cf3();
  } else if(self.location.target === "destination_duga") {
    var_3b25dd0c = function_18973f36();
  } else if(self.location.target === "destination_zoo") {
    var_3b25dd0c = function_1daeb3f();
  } else {
    var_3b25dd0c = function_7ae74cf3();
  }

  var_43123efe = util::spawn_model(var_3b25dd0c[0], self.var_b8ca9d7 gettagorigin("tag_cage_attach"));
  waitframe(1);

  if(isDefined(var_43123efe) && isDefined(self.var_b8ca9d7)) {
    var_43123efe setscale(var_3b25dd0c[1]);
    var_43123efe.v_ang = var_3b25dd0c[2];
    var_43123efe.v_offset = var_3b25dd0c[3];
    var_43123efe notsolid();
    return var_43123efe;
  }
}

function function_3236ac12() {
  var_55b751c2 = array(#"p7_rus_light_lamp_oil", #"hash_7fd49bea40f14b60", #"p8_nt4_radio_transceiver_01", #"ach_sandbag_cover_03", #"hash_2444d731ff4d4123");
  str_model = array::random(var_55b751c2);
  n_scale = 1;
  v_ang = (0, 0, 0);
  v_offset = (0, 0, 0);

  if(str_model == # "hash_7fd49bea40f14b60") {
    n_scale = 0.9;
  } else if(str_model == # "p8_nt4_radio_transceiver_01") {
    v_ang = (0, 180, 0);
  } else if(str_model == # "ach_sandbag_cover_03") {
    n_scale = 0.75;
  }

  var_3b25dd0c = array(str_model, n_scale, v_ang, v_offset);
  return var_3b25dd0c;
}

function function_44b02002() {
  var_55b751c2 = array(#"p7_cai_weigh_scale_vintage_blue", #"p8_soc_food_spice_sack_02_full_03", #"p8_food_fruit_apple_crate", #"hash_2444d731ff4d4123");
  str_model = array::random(var_55b751c2);
  n_scale = 1;
  v_ang = (0, 0, 0);
  v_offset = (0, 0, 0);

  if(str_model == # "p7_cai_weigh_scale_vintage_blue") {
    v_ang = (0, 180, 0);
  }

  var_3b25dd0c = array(str_model, n_scale, v_ang, v_offset);
  return var_3b25dd0c;
}

function function_18973f36() {
  var_55b751c2 = array(#"p8_nt4_soviet_statue", #"p9_rm_dwn_coffee_maker_vintage_espresso", #"p8_life_preserver_ring_old_01", #"p8_nt4_globe_earth", #"hash_2444d731ff4d4123");
  str_model = array::random(var_55b751c2);
  n_scale = 1;
  v_ang = (0, 0, 0);
  v_offset = (0, 0, 0);

  if(str_model == # "p8_life_preserver_ring_old_01") {
    n_scale = 0.75;
    v_offset = (0, 0, 16);
  } else if(str_model == # "p8_nt4_soviet_statue") {
    n_scale = 0.18;
    v_ang = (0, 180, 0);
  } else if(str_model == # "p9_rm_dwn_coffee_maker_vintage_espresso") {
    v_ang = (0, 180, 0);
  } else if(str_model == # "p8_nt4_globe_earth") {
    n_scale = 1.5;
  }

  var_3b25dd0c = array(str_model, n_scale, v_ang, v_offset);
  return var_3b25dd0c;
}

function function_7ae74cf3() {
  var_55b751c2 = array(#"p8_aut_toys_christmas_globe_snow", #"p8_wmd_generator", #"p9_rm_stm_ice_hockey_goal_net", #"p8_wz_ep_snowman", #"hash_2444d731ff4d4123");
  str_model = array::random(var_55b751c2);
  n_scale = 1;
  v_ang = (0, 0, 0);
  v_offset = (0, 0, 0);

  if(str_model == # "p8_wmd_generator") {
    n_scale = 0.7;
    v_ang = (0, 90, 0);
  } else if(str_model == # "p9_rm_stm_ice_hockey_goal_net") {
    n_scale = 0.45;
    v_ang = (0, 180, 0);
  } else if(str_model == # "p8_wz_ep_snowman") {
    n_scale = 0.4;
    v_ang = (0, 180, 0);
  } else if(str_model == # "p8_aut_toys_christmas_globe_snow") {
    n_scale = 2;
    v_ang = (0, -90, 0);
  }

  var_3b25dd0c = array(str_model, n_scale, v_ang, v_offset);
  return var_3b25dd0c;
}

function function_1daeb3f() {
  var_55b751c2 = array(#"p9_rm_zoo_gift_statue_aml_elephant", #"p8_stuffed_bull", #"p9_machine_arcade_02");
  str_model = array::random(var_55b751c2);
  n_scale = 1;
  v_ang = (0, 0, 0);
  v_offset = (0, 0, 0);

  if(str_model == # "p9_rm_zoo_gift_statue_aml_elephant") {
    v_ang = (0, 180, 0);
  } else if(str_model == # "p8_stuffed_bull") {
    v_ang = (0, -90, 0);
    v_offset = (0, 0, 8);
  } else {
    v_ang = (0, 90, 0);
    n_scale = 0.4;
  }

  var_3b25dd0c = array(str_model, n_scale, v_ang, v_offset);
  return var_3b25dd0c;
}

function function_dc378d61() {
  v_org = self.var_b8ca9d7 gettagorigin("tag_cage_attach");

  if(math::cointoss()) {
    var_43123efe = zm_powerups::specific_powerup_drop(array("full_ammo", "bonus_points_team", "nuke", "insta_kill", "double_points"), v_org, #"allies", undefined, undefined, 1);

    if(isDefined(var_43123efe)) {
      var_43123efe.var_5c6f6051 = 80;
      v_offset = v_org + (0, 0, 12);

      if(var_43123efe.model === # "p7_zm_power_up_nuke") {
        var_43123efe setscale(0.75);
      }
    }
  } else {
    var_43123efe = util::spawn_model("p9_gold_surcrystal_medium_01", v_org, self.var_b8ca9d7.angles, undefined, 1);

    if(isDefined(var_43123efe)) {
      var_43123efe setscale(0.75);
      var_43123efe val::set("loot_pod", "takedamage", 1);
      var_43123efe.health = 5;
      var_43123efe.var_2d1326e = 1;
      v_offset = v_org;
      level thread namespace_58949729::function_8265e656(var_43123efe);
    }
  }

  if(isDefined(var_43123efe)) {
    var_43123efe moveto(v_offset, 0.05);
    var_43123efe waittill(#"movedone");

    if(isDefined(var_43123efe)) {
      return var_43123efe;
    }
  }
}

function function_5466a4e2() {
  self endon(#"objective_ended");
  self waittill(#"payload_go");
  wait 1;
  level namespace_7589cf5c::play_vo("objectivePayloadStart");
  wait 1;
  level namespace_7589cf5c::play_vo("objectivePayloadStartResponse");
  self.var_b8ca9d7 waittill(#"active");
  self.var_b8ca9d7 namespace_7589cf5c::function_ac709d66(self, #"hash_52187d4a8a76de9f");

  while(!self.var_74ec00fb) {
    wait 1;
  }

  wait 1;
  self.var_b8ca9d7 namespace_7589cf5c::function_ac709d66(self, #"hash_206f96ca8a8b9649");
}

function function_9f91a425(instance) {
  instance endon(#"objective_ended");
  self waittill(#"final_portal");
  self thread namespace_7589cf5c::function_ac709d66(instance, #"hash_3fa31698f9825caf");
}

function function_28250c29() {
  self waittill(#"objective_ended");
  wait 1;
  level namespace_7589cf5c::play_vo("objectivePayloadEnd");
  wait 1;
  level thread namespace_7589cf5c::play_vo("objectivePayloadEndResponse");
  level flag::set(#"spawn_safehouse");
}

function function_e45c5bc0(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    self waittill(#"scan");
    self namespace_7589cf5c::function_ac709d66(self, #"hash_5ebc917253be6eba");

    if(isDefined(instance.var_f16db373)) {
      while(true) {
        if(isDefined(instance.var_f16db373) && isalive(self) && distance2dsquared(self.origin, instance.var_f16db373.origin) <= 160000) {
          break;
        }

        wait 0.1;
      }
    } else if(isDefined(self.mdl_portal)) {
      while(true) {
        if(isDefined(self.mdl_portal) && isalive(self) && distance2dsquared(self.origin, self.mdl_portal.origin) <= 160000) {
          break;
        }

        wait 0.1;
      }
    }

    if(instance.variant === "payload_teleport") {
      self.var_e588b6c3 = 1;
    }

    self namespace_7589cf5c::function_ac709d66(self, #"hash_404e25761f89998b");
    self waittill(#"exam_done");

    if(instance.variant === "payload_noteleport") {
      self thread namespace_7589cf5c::function_ac709d66(self, #"hash_a983fbd390eeb63");
    } else {
      self thread namespace_7589cf5c::function_ac709d66(instance, "vox_obj_epl_rift_stbl_orvr");
    }

    wait 1.5;
    self notify(#"hash_18fad858ffdbd3d");
  }
}

function function_1eef26bc(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    if(!self.var_a123c71) {
      wait 10;

      if(!self.var_a123c71 && !self.var_b591d382 && !self.var_ee53f643 && !is_true(self.abnormal_status.emped)) {
        self namespace_7589cf5c::function_ac709d66(instance, #"hash_165229d1cb432efa");
        wait 2;
      }
    }

    wait 1;
  }
}

function function_98da33e1() {
  self endon(#"objective_ended");
  self.var_b8ca9d7 endon(#"death");
  self.var_b8ca9d7.var_43123efe endon(#"death");
  self.var_b8ca9d7 thread function_46850180(self);

  while(true) {
    s_result = self.var_b8ca9d7 waittill(#"state_change");

    switch (s_result.state) {
      case # "calm":
        str_shot = "Shot 1";
        n_wait = 6.05;
        break;
      case # "stressed":
        str_shot = "Shot 2";
        n_wait = 6.2;
        break;
      case # "agitated":
        str_shot = "Shot 3";
        n_wait = 6.7;
        break;
    }

    self thread function_8b312db9(str_shot);
    self.var_b8ca9d7.var_43123efe.str_shot = str_shot;
    wait n_wait;
  }
}

function function_46850180(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");
  self.var_43123efe endon(#"death");

  while(true) {
    zombies = function_a38db454(self.origin, 1500);
    var_6d32286d = 0;

    foreach(zombie in zombies) {
      if(distance2dsquared(self.origin, zombie.origin) <= 2250000 && !isvehicle(zombie)) {
        var_6d32286d = 1;
      }
    }

    if(var_6d32286d || is_true(self.var_e588b6c3) || !isDefined(self.is_deployed)) {
      self notify(#"state_change", {
        #state: "agitated"});
      n_wait = 6.7;
    } else if(isDefined(zombies) && zombies.size > 0) {
      self notify(#"state_change", {
        #state: "stressed"});
      n_wait = 6.2;
    } else {
      self notify(#"state_change", {
        #state: "calm"});
      n_wait = 6.05;
    }

    wait n_wait;
  }
}

function function_8b312db9(str_shot) {
  self.var_1cd294c7 thread scene::play(#"p9_fxanim_sv_payload_monkey_bundle", str_shot, self.var_b8ca9d7.var_43123efe);
}

function function_68ec5e25() {
  self endon(#"objective_ended");
  self.var_b8ca9d7 endon(#"death");
  self.var_b8ca9d7 waittill(#"ambush");
  n_spawns = function_1fdb6ebc();
  a_s_pts = array::get_all_closest(self.var_b8ca9d7.origin, struct::get_array(#"ambush_pt"));

  for(i = 0; i < a_s_pts.size; i++) {
    for(j = 0; j < n_spawns; j++) {
      self.var_b8ca9d7 thread function_dd9b1007(self, a_s_pts[i].origin, a_s_pts[i].angles);
      wait 0.1;
    }

    wait 0.5;
  }
}

function function_83e5a141() {
  self waittill(#"payload_go");

  if(isDefined(self.contentgroups[#"hash_5615a127abad1354"])) {
    self.var_bce10cdf = content_manager::spawn_script_model(self.contentgroups[#"hash_5615a127abad1354"][0], #"hash_6a83a06a639fcc6b", 1);
    self.var_bce10cdf ghost();
  }

  wait 0.1;
  self.var_b8ca9d7 notify(#"state_change", {
    #state: "calm"});
  self.var_b8ca9d7 waittill(#"deployed");
  wait 5;
  self.var_b8ca9d7.is_deployed = 1;
}

function function_f5087df2() {
  self waittill(#"objective_ended");
  callback::remove_on_ai_killed(&zombie_death_watcher);

  foreach(player in getplayers()) {
    level.var_31028c5d prototype_hud::function_817e4d10(player, 0);
  }

  namespace_7589cf5c::function_ed193293(self);

  if(self.success) {
    level thread namespace_cda50904::function_a92a93e9(self.mdl_reward.origin, self.mdl_reward.angles);

    if(!is_true(level.var_c65e4312)) {
      foreach(player in function_a1ef346b()) {
        player zm_stats::increment_challenge_stat(#"hash_28f078b404c0e6d9");
      }
    }

    level.var_c65e4312 = undefined;
    return;
  }

  wait 1;

  if(isDefined(self.var_b8ca9d7)) {
    self.var_b8ca9d7 dodamage(self.var_b8ca9d7.health, self.var_b8ca9d7.origin);
  }
}

function function_de42eeef(str_model, v_offset, v_ang, n_forward, n_scale) {
  self setbrake(1);
  wait 0.5;
  v_forward = self.origin + vectornormalize(anglesToForward(self.angles)) * n_forward;
  var_6d29abb0 = util::spawn_model(str_model, v_forward + v_offset, v_ang);

  if(isDefined(var_6d29abb0)) {
    wait 0.1;
    var_6d29abb0.health = int(self.health * 0.4);
    var_6d29abb0 setscale(n_scale);
    var_6d29abb0 linkto(self);
    self.var_a04ece6e = var_6d29abb0;
  }
}

function function_d137dbd4(instance, activator) {
  if(isPlayer(activator)) {
    callback::on_ai_killed(&zombie_death_watcher);
    instance notify(#"payload_go");
    instance thread function_17f1d0f3();
    instance.var_74ec00fb = 0;
    instance.n_zombies_max = function_23ab0822();

    foreach(player in getplayers()) {
      level.var_31028c5d prototype_hud::function_7491d6c5(player, #"hash_838284821745ec7");
      level.var_31028c5d prototype_hud::set_active_objective_string(player, #"hash_838284821745ec7");
      level.var_31028c5d prototype_hud::function_817e4d10(player, 2);
    }

    function_3ef1d58a(instance, 1);

    if(!isDefined(level.var_97e461d4)) {
      namespace_7589cf5c::function_1e45b156(instance);
    }

    wait 6;
  }
}

function function_23ab0822() {
  switch (getplayers().size) {
    case 1:
      n_spawns = 8;
      break;
    case 2:
      n_spawns = 12;
      break;
    case 3:
      n_spawns = 16;
      break;
    case 4:
      n_spawns = 20;
      break;
  }

  return n_spawns;
}

function function_27033bf7(instance) {
  self endon(#"death");
  self val::set("payload", "takedamage", 1);
  self.overridevehicledamage = &function_ae595d6e;
  self.var_aa4b496 = 0;
  self.health = 6000;
  self.var_265cb589 = 1;
  self thread function_eb89f65f(instance);
  nd_start = getvehiclenode(self.s_start.target, "targetname");
  nd_start.var_d5ebc20b = getvehiclenode(nd_start.script_string, "targetname");
  n_time = nd_start.script_int;
  self vehicle::get_on_path(nd_start);
  waitframe(1);
  instance waittill(#"payload_go");
  self playrumblelooponentity(#"sr_machinery_rumble");
  self thread function_9c54feb0(instance);
  self thread function_612a9925();
  self thread function_6ae999c2(instance);
  instance.var_1ac40948 playrumblelooponentity(#"hash_1903f70fddbadc53");
  instance.var_1ac40948 scene::play(#"p9_fxanim_sv_payload_delivery_open_bundle", instance.var_1ac40948);
  instance.var_1ac40948 stoprumble(#"hash_1903f70fddbadc53");
  instance.var_1ac40948 playrumbleonentity(#"sr_canister_damage_vehicle_rumble");

  if(isDefined(instance.var_f2af10b2)) {
    instance.var_f2af10b2 delete();
  }

  self notify(#"payload_start");
  self playSound(#"hash_388c12acd0e0928");
  wait 1;

  if(isDefined(instance.var_f2065b9e)) {
    instance.var_f2065b9e notsolid();
  }

  self thread vehicle::go_path();
  self thread function_87de8025(instance);
  self thread function_8469f022(instance);
  self thread function_33284b66(instance);
  self thread function_ca92ed05(instance);
  self thread function_89951438(instance);
  self.var_a123c71 = 1;
  self waittill(#"deployed");
  self clientfield::increment("" + # "payload_health");
  self.var_a123c71 = 0;
  self thread function_e45c5bc0(instance);
  self thread function_1eef26bc(instance);
  self thread function_9f91a425(instance);
  self thread final_attack(instance);
  self thread function_79ae8e99(instance);
  self thread function_fe857bf3(instance);
  self thread function_7dc0fd48(instance);
  self thread payload_teleport(instance);
  self thread function_41bc60b6(instance);
  self thread function_7d3ebd69(instance);
  self thread function_6fb6800a(instance);
  self thread function_738143f5(instance);
  self thread function_d57cb15b(instance);

  if(instance.variant === "payload_noteleport") {
    self waittill(#"final_rift");
  }

  self.mdl_portal = util::spawn_model("tag_origin", nd_start.var_d5ebc20b.origin, (0, 90, 0));
  self.mdl_portal clientfield::set("" + # "portal", 1);
  self.var_edbf8a99 = util::spawn_model("collision_player_only_192", self.mdl_portal.origin, self.mdl_portal.angles);
  self.var_3e5ed63d = util::spawn_model("tag_origin", self.mdl_portal.origin + (0, 0, -1000), self.mdl_portal.angles);
  self.mdl_portal thread function_fd3059d0(instance);

  if(isDefined(self.var_edbf8a99)) {
    self.var_edbf8a99 ghost();
  }
}

function function_3b34bc1b(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");
  self waittill(#"final_rift");
  self.mdl_beam = util::spawn_model("tag_origin", instance.var_f16db373.origin);
  waitframe(1);

  if(isDefined(self.mdl_beam)) {
    wait 1.5;
    self.mdl_beam clientfield::set("" + # "payload_teleport", 2);
    self thread function_e0c5b0a4(instance);
  }
}

function function_ca92ed05(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    if(is_true(self.abnormal_status.emped)) {
      level namespace_7589cf5c::play_vo("objectivePayloadMalfunction");
      wait 0.5;
      self namespace_7589cf5c::function_ac709d66(self, #"hash_42e191393187cfdb");

      while(is_true(self.abnormal_status.emped)) {
        wait 0.5;
      }

      self namespace_7589cf5c::function_ac709d66(self, #"hash_6170663b9a995a23");
    }

    wait 0.5;
  }
}

function function_33284b66(instance) {
  instance endon(#"objective_ended");
  self waittill(#"activate");

  if(isDefined(instance.var_f2065b9e)) {
    instance.var_f2065b9e solid();
  }

  self clientfield::set("" + # "payload_activate", 1);
  wait 2;
  self notify(#"active");
}

function function_ae595d6e(einflictor, eattacker, idamage, idflags, smeansofdeath, weapon, vpoint, vdir, shitloc, vdamageorigin, psoffsettime, damagefromunderneath, modelindex, partname, vsurfacenormal) {
  if(isDefined(modelindex) && isPlayer(modelindex)) {
    partname = 0;
    return partname;
  } else if(isalive(modelindex)) {
    if(!self.var_aa4b496) {
      self thread function_d5c3d218();
    }

    if(vsurfacenormal === "MOD_MELEE") {
      self playSound(#"hash_1ddeb8af5a217a6e");
    } else if(vsurfacenormal === "MOD_UNKNOWN") {
      partname = 0;
    }
  }

  if(partname > 50) {
    partname = 50;
  }

  if(partname > 0) {
    level.var_c65e4312 = 1;
  }

  return partname;
}

function function_6e7546c5() {
  self endon(#"objective_ended");
  self.var_b8ca9d7 endon(#"death");
  self.var_fa6b9965 = [];

  for(i = 0; i < self.var_d4f4d124.size; i++) {
    foreach(var_2b357ce9 in self.var_d4f4d124) {
      if(var_2b357ce9.script_int == i) {
        self.var_fa6b9965[i] = var_2b357ce9;
      }
    }
  }

  var_edf7d1ed = 0;
  self waittill(#"payload_go");
  self thread function_1c8e1b20();

  if(self.variant === "payload_noteleport") {
    self.var_f16db373 = util::spawn_model("tag_origin", self.var_fa6b9965[var_edf7d1ed].origin);
  }

  wait 0.1;

  if(isDefined(self.var_f16db373) || self.variant === "payload_teleport") {
    if(self.variant === "payload_noteleport") {
      self thread function_4ef90aaa();
    }

    while(true) {
      s_result = self.var_b8ca9d7 waittill(#"rift", #"reached_end_node", #"final_rift");

      if(s_result._notify !== "final_rift") {
        self.var_b8ca9d7.var_f5d0e3f6 = 1;
      }

      if(s_result._notify === "rift") {
        self.var_b8ca9d7 clientfield::increment("" + # "payload_scan");
        self.var_b8ca9d7.var_ee53f643 = 1;

        if(self.variant === "payload_noteleport") {
          var_edf7d1ed++;
          self function_c9b143b(var_edf7d1ed);
          function_3ef1d58a(self, var_edf7d1ed + 1);

          if(var_edf7d1ed >= 2) {
            self.var_b8ca9d7 thread function_3b34bc1b(self);
          }

          self.var_b8ca9d7 notify(#"exam_done");
        } else {
          wait 6.5;
          self.var_b8ca9d7 notify(#"exam_done");
          self.var_b8ca9d7 waittill(#"hash_18fad858ffdbd3d");
        }
      } else {
        self.var_b8ca9d7 notify(#"exam_done");
      }

      wait 1;
      self.var_b8ca9d7.var_f5d0e3f6 = 0;
      self.var_b8ca9d7.var_ee53f643 = 0;

      if(isDefined(self.var_f16db373) && self.variant === "payload_noteleport") {
        self thread function_4ef90aaa();
      }
    }
  }
}

function function_41bc60b6(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    self waittill(#"enter");
    self thread function_1bb2940d(instance);
    self clientfield::set("" + # "payload_enter", 1);
    self waittill(#"reached_end_node");
    self clientfield::set("" + # "payload_enter", 0);
  }
}

function function_1bb2940d(instance) {
  if(is_true(self.isspeaking)) {
    self waittill(#"done_speaking");
  }

  wait 0.25;
  self thread namespace_7589cf5c::function_ac709d66(instance, #"hash_3b4b38d7e66e6880");
}

function function_c9b143b(var_edf7d1ed) {
  self endon(#"objective_ended");
  self.var_f16db373 playrumblelooponentity(#"hash_1903f70fddbadc53");
  wait 7.5;
  self.var_f16db373 stoprumble(#"hash_1903f70fddbadc53");
  self.var_f16db373 clientfield::set("" + # "hash_2a7da9a87ecef87b", 0);
  wait 3;
  self.var_f16db373 moveto(self.var_fa6b9965[var_edf7d1ed].origin, 0.05);
}

function function_4ef90aaa() {
  self endon(#"objective_ended");
  self.var_b8ca9d7 endon(#"death");
  self.var_f16db373 endon(#"death");
  self.var_b8ca9d7 waittill(#"scan");
  self.var_f16db373 clientfield::set("" + # "hash_2a7da9a87ecef87b", 1);
}

function function_1c8e1b20() {
  self endon(#"objective_ended");
  self.var_b8ca9d7 endon(#"death");
  self.var_b8ca9d7 waittill(#"hash_193c92bb1c6df0e7");

  if(isDefined(self.var_f16db373)) {
    self.var_f16db373 delete();
  }
}

function function_d5c3d218() {
  self endon(#"death");
  self.var_aa4b496 = 1;
  self playLoopSound(#"hash_2a034c2643fc1322");
  wait 4.75;
  self stoploopsound();
  self.var_aa4b496 = 0;
}

function function_612a9925() {
  self endon(#"death");
  self.n_start_health = self.health;
  self.max_health = self.n_start_health;
  var_8da3e170 = self.health / self.n_start_health;
  zm_sq::sndonoverride_eye_(var_8da3e170);
  zm_sq::function_2398ab16("objective_ended");

  while(true) {
    var_c3a3ae13 = self.health / self.n_start_health;

    if(var_c3a3ae13 >= 0 && var_8da3e170 != var_c3a3ae13) {
      zm_sq::sndonoverride_eye_(var_c3a3ae13);
    }

    var_8da3e170 = var_c3a3ae13;

    if(var_c3a3ae13 <= 0.5 && !is_true(self.var_5e22f781)) {
      self.var_5e22f781 = 1;
      level thread namespace_7589cf5c::play_vo("objectivePayloadHealthHalf");
    }

    if(var_c3a3ae13 <= 0.2 && !is_true(self.var_2eb5c0e8)) {
      self.var_2eb5c0e8 = 1;
      level thread namespace_7589cf5c::play_vo("objectivePayloadHealthCritical");
    }

    waitframe(1);
  }
}

function function_7ae9616f(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  var_d730bd8c = getvehiclenode("sanatorium_path", "targetname");
  var_b54d7065 = getdynentarray("dynent_garage_button");
  doors = array::get_all_closest(var_d730bd8c.origin, var_b54d7065);
  var_dd05b6d = array(doors[0], doors[1]);

  foreach(door in var_dd05b6d) {
    if(function_ffdbe8c2(door)) {
      return;
    }
  }

  for(i = 0; i < 2; i++) {
    dynent_use::use_dynent(var_dd05b6d[i]);
    wait randomfloatrange(0.2, 0.5);
  }
}

function function_7dc0fd48(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  self waittill(#"door");
  var_4b03566e = (100, 100, 75);
  var_bcdc6e24 = self getcentroid();
  var_e86a4d9 = function_db4bc717(var_bcdc6e24, var_4b03566e);

  foreach(dynent in var_e86a4d9) {
    if(isDefined(dynent)) {
      dynent dodamage(dynent.health, dynent.origin, undefined, undefined, "none", "MOD_EXPLOSIVE");
    }
  }
}

function function_dcf94cdf(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  self waittill(#"custom");
  s_pt = struct::get(instance.targetname, "script_noteworthy");

  if(!isDefined(s_pt)) {
    s_pt = array::get_all_closest(self.origin, struct::get_array("payload_custom"))[0];
  }

  if(isDefined(s_pt)) {
    a_s_pts = namespace_85745671::function_e4791424(s_pt.origin, 32, 40, s_pt.radius);

    if(!isDefined(a_s_pts)) {
      return;
    }

    var_559503f1 = array::randomize(a_s_pts);
    n_spawns = function_cb32786d();

    for(i = 0; i < n_spawns; i++) {
      if(isDefined(var_559503f1[i])) {
        self thread function_dd9b1007(instance, var_559503f1[i].origin, var_559503f1[i].angles);
      }

      wait 0.1;
    }
  }
}

function function_81fd5bee() {
  self endon(#"objective_ended");
}

function function_753d6448(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  self waittill(#"custom");
  a_s_pts = struct::get_array(#"hash_18fe18808e205477");

  if(!isDefined(a_s_pts)) {
    return;
  }

  n_spawns = function_cb32786d();

  for(i = 0; i < n_spawns; i++) {
    s_pt = array::random(a_s_pts);

    if(isDefined(s_pt)) {
      self thread function_dd9b1007(instance, s_pt.origin, s_pt.angles);
    }

    wait randomfloatrange(0.5, 1);
  }
}

function function_cb32786d() {
  n_players = getplayers().size;

  switch (n_players) {
    case 1:
      n_spawns = 10;
      break;
    case 2:
      n_spawns = 16;
      break;
    case 3:
      n_spawns = 22;
      break;
    case 4:
      n_spawns = 30;
      break;
  }

  return n_spawns;
}

function function_6fb6800a(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");

  while(true) {
    self waittill(#"attack");
    self thread function_9d51d729(instance);
  }
}

function function_9d51d729(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");

  if(isDefined(self.currentnode.script_height)) {
    var_9df66c84 = (0, 0, self.currentnode.script_height);
  } else {
    var_9df66c84 = (0, 0, 0);
  }

  v_forward = vectornormalize(anglesToForward(self.currentnode.angles)) * self.currentnode.radius + self.currentnode.origin;

  if(!isDefined(v_forward)) {
    return;
  }

  if(isDefined(self.currentnode.script_radius)) {
    n_radius = self.currentnode.script_radius;
  } else {
    n_radius = 100;
  }

  a_s_pts = namespace_85745671::function_e4791424(v_forward + var_9df66c84, 16, 40, n_radius);

  if(!isDefined(a_s_pts)) {
    return;
  }

  var_559503f1 = array::randomize(a_s_pts);
  n_spawns = function_1fdb6ebc();

  for(i = 0; i < n_spawns; i++) {
    if(isDefined(var_559503f1[i]) && instance.var_74ec00fb < instance.n_zombies_max) {
      self thread function_dd9b1007(instance, var_559503f1[i].origin, var_559503f1[i].angles);
    }

    wait randomfloatrange(0.5, 1);
  }
}

function function_1fdb6ebc() {
  n_players = getplayers().size;

  switch (n_players) {
    case 1:
      n_spawns = randomintrange(2, 5);
      break;
    case 2:
      n_spawns = randomintrange(2, 5);
      break;
    case 3:
      n_spawns = randomintrange(3, 5);
      break;
    case 4:
      n_spawns = randomintrange(4, 6);
      break;
    default:
      n_spawns = randomintrange(3, 5);
      break;
  }

  return n_spawns;
}

function function_738143f5(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");

  while(true) {
    self waittill(#"assault");
    self thread function_95015f9a(instance);
  }
}

function function_d57cb15b(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");

  while(true) {
    self waittill(#"dogs");
    n_players = getplayers().size;

    if(!isDefined(n_players)) {
      continue;
    }

    v_ground = self function_6d122cef();

    if(!isDefined(v_ground)) {
      return;
    }

    a_s_pts = namespace_85745671::function_e4791424(v_ground, 24, 80, 200);

    if(!isDefined(a_s_pts)) {
      return;
    }

    var_559503f1 = array::randomize(a_s_pts);
    self function_22281e97(instance, n_players, var_559503f1);
  }
}

function function_7d3ebd69(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  self waittill(#"heavy");
  level thread namespace_7589cf5c::play_vo("objectivePayloadFinalPortal");
  level flag::wait_till("spawn_zombies");
  v_pt = self.s_portal.origin;
  v_ang = self.s_portal.angles;
  str_aitype = function_899e4373(level.var_b48509f9);

  if(isDefined(str_aitype)) {
    var_e4c6e64a = namespace_85745671::function_9d3ad056(str_aitype, v_pt, v_ang, "payload_zombie");
  } else {
    var_e4c6e64a = namespace_85745671::function_9d3ad056(#"hash_4f87aa2a203d37d0", v_pt, v_ang, "payload_zombie");
  }

  wait 0.1;

  if(isDefined(var_e4c6e64a)) {
    var_e4c6e64a.var_a950813d = 1;
    player = awareness::function_d7fedde2(var_e4c6e64a);
    awareness::function_c241ef9a(var_e4c6e64a, player, 10);
    var_e4c6e64a thread function_6f9744dc(instance, self);
  }
}

function function_899e4373(var_661691aa) {
  switch (var_661691aa) {
    case 1:
    case 2:
      var_de82b392 = [#"hash_4f87aa2a203d37d0"];
      break;
    case 3:
    case 4:
      var_de82b392 = [#"hash_4f87aa2a203d37d0", #"spawner_bo5_avogadro_sr", #"spawner_bo5_soa"];
      break;
    case 5:
      var_de82b392 = [#"hash_4f87aa2a203d37d0", #"spawner_bo5_avogadro_sr", #"spawner_bo5_soa", #"spawner_zm_steiner"];
      break;
    default:
      var_de82b392 = [#"hash_4f87aa2a203d37d0", #"spawner_bo5_avogadro_sr", #"spawner_bo5_soa", #"spawner_bo5_mechz_sr", #"spawner_zm_steiner", #"spawner_bo5_abom"];
      break;
  }

  str_aitype = array::random(var_de82b392);
  return str_aitype;
}

function function_6f9744dc(instance, var_b8ca9d7) {
  instance endon(#"objective_ended");
  self endon(#"death");
  var_b8ca9d7 endon(#"death");
  var_b8ca9d7 waittill(#"final_attack");
  level thread namespace_7589cf5c::play_vo("objectivePayloadFinalPortalResponse");
  self animation::play("ai_zm_dlc3_armored_zombie_enrage");
}

function function_95015f9a(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  v_ground = self function_6d122cef();

  if(!isDefined(v_ground)) {
    return;
  }

  a_s_pts = namespace_85745671::function_e4791424(v_ground, 32, 40, 1200);

  if(!isDefined(a_s_pts)) {
    return;
  }

  var_559503f1 = array::randomize(a_s_pts);
  n_spawns = function_dae1a57b();

  for(i = 0; i < n_spawns; i++) {
    if(isDefined(var_559503f1[i]) && instance.var_74ec00fb < instance.n_zombies_max) {
      v_ang = (self.angles[0], self.angles[1] + 180, self.angles[2]);
      self thread function_dd9b1007(instance, var_559503f1[i].origin, v_ang);
    }

    wait 0.1;
  }
}

function function_6d122cef() {
  self endon(#"death");
  nd_current = self.currentnode;

  if(isDefined(nd_current)) {
    v_forward = vectornormalize(anglesToForward(nd_current.angles)) * 2400 + nd_current.origin;
  } else {
    v_forward = vectornormalize(anglesToForward(self.angles)) * 2400 + self.origin;
  }

  if(isDefined(v_forward)) {
    v_ground = groundtrace(v_forward + (0, 0, 1000), v_forward + (0, 0, -1000), 0, self)[#"position"];
  }

  if(!isDefined(v_ground)) {
    if(isDefined(self.nextnode)) {
      v_ground = self.nextnode.origin;
    } else {
      v_ground = self.origin;
    }
  }

  return v_ground;
}

function function_dd9b1007(instance, v_spawnpt, v_ang) {
  self endon(#"death");
  instance endon(#"objective_ended");
  level flag::wait_till("spawn_zombies");
  str_aitype = function_aece4588(level.var_b48509f9);

  if(namespace_7589cf5c::function_82e262cf(str_aitype)) {
    if(isDefined(instance.var_38c710c3)) {
      n_cooldown = namespace_7589cf5c::function_190c51a9();
      var_be32c966 = float(gettime()) / 1000 - instance.var_38c710c3;

      if(var_be32c966 < n_cooldown) {
        str_aitype = namespace_7589cf5c::function_b9e4c169();
      } else {
        instance.var_38c710c3 = undefined;
      }
    }

    if(instance.var_2133c784 >= instance.var_61c57c53 || instance.var_b803db9c >= instance.var_5de17ec9) {
      str_aitype = namespace_7589cf5c::function_b9e4c169();
    }
  }

  ai_spawned = namespace_85745671::function_9d3ad056(str_aitype, v_spawnpt, v_ang, "payload_zombie");
  wait 0.1;

  if(isDefined(ai_spawned)) {
    ai_spawned.var_a950813d = 1;
    instance.var_74ec00fb++;

    if(namespace_7589cf5c::function_82e262cf(ai_spawned.aitype)) {
      instance.var_38c710c3 = float(gettime()) / 1000;
      instance.var_2133c784++;
      instance.var_b803db9c++;
      ai_spawned callback::function_d8abfc3d(#"on_ai_killed", &function_c36cb7b1);
    } else {
      ai_spawned callback::function_d8abfc3d(#"on_ai_killed", &function_b3791df9);
    }

    ai_spawned thread function_bf606a73(self, instance);
  }
}

function function_c36cb7b1(params) {
  if(isDefined(level.contentmanager.activeobjective) && level.contentmanager.activeobjective.var_b803db9c) {
    level.contentmanager.activeobjective.var_b803db9c--;
  }
}

function function_b3791df9(instance) {
  if(isDefined(level.contentmanager.activeobjective) && level.contentmanager.activeobjective.var_74ec00fb) {
    level.contentmanager.activeobjective.var_74ec00fb--;
  }
}

function function_84d85877(instance) {
  instance endon(#"objective_ended");
  self waittill(#"death");
  instance.var_74ec00fb--;
}

function function_22281e97(instance, n_players, var_559503f1) {
  self endon(#"death");
  instance endon(#"objective_ended");
  var_de82b392 = [];
  instance.var_e00b0988 = min(randomintrangeinclusive(n_players + level.var_b48509f9, n_players + level.var_b48509f9 * 2), 6);

  if(math::cointoss()) {
    var_6b2ccc6b = # "hash_7a8b592728eec95d";
  } else if(level.var_b48509f9 < 2) {
    var_6b2ccc6b = # "hash_7a8b592728eec95d";
  } else {
    var_6b2ccc6b = # "hash_12a17ab3df5889eb";
  }

  for(i = 0; i < instance.var_e00b0988; i++) {
    if(math::cointoss(60)) {
      var_de82b392[var_de82b392.size] = var_6b2ccc6b;
      continue;
    }

    var_de82b392[var_de82b392.size] = var_6b2ccc6b;
  }

  for(i = 0; i < var_de82b392.size; i++) {
    level flag::wait_till("spawn_zombies");

    if(isDefined(var_559503f1[i])) {
      v_ang = anglesToForward(var_559503f1[i].origin - self.origin);
      ai_spawned = namespace_85745671::function_9d3ad056(var_de82b392[i], var_559503f1[i].origin, v_ang, "payload_zombie");
      wait 0.1;

      if(isDefined(ai_spawned)) {
        ai_spawned.var_a950813d = 1;
        ai_spawned thread function_bf606a73(self, instance);
      }
    }

    wait randomfloatrange(0.5, 1);
  }
}

function final_attack(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  self waittill(#"final_attack");
  var_559503f1 = array::randomize(self.var_559503f1);
  n_spawned = 0;
  n_total = function_ce92dcb0();

  for(i = 0; i < n_total; i++) {
    level flag::wait_till("spawn_zombies");
    str_aitype = function_aece4588(level.var_b48509f9);

    if(namespace_7589cf5c::function_82e262cf(str_aitype)) {
      if(isDefined(instance.var_38c710c3)) {
        n_cooldown = namespace_7589cf5c::function_190c51a9();
        var_be32c966 = float(gettime()) / 1000 - instance.var_38c710c3;

        if(var_be32c966 < n_cooldown) {
          str_aitype = namespace_7589cf5c::function_b9e4c169();
        } else {
          instance.var_38c710c3 = undefined;
        }
      }

      if(instance.var_2133c784 >= instance.var_61c57c53 || instance.var_b803db9c >= instance.var_5de17ec9) {
        str_aitype = namespace_7589cf5c::function_b9e4c169();
      }
    }

    ai_spawned = namespace_85745671::function_9d3ad056(str_aitype, var_559503f1[i].origin, var_559503f1[i].angles, "payload_zombie");
    wait 0.1;

    if(isDefined(ai_spawned)) {
      ai_spawned.var_a950813d = 1;

      if(namespace_7589cf5c::function_82e262cf(ai_spawned.aitype)) {
        instance.var_38c710c3 = float(gettime()) / 1000;
        instance.var_2133c784++;
        instance.var_b803db9c++;
        ai_spawned callback::function_d8abfc3d(#"on_ai_killed", &function_c36cb7b1);
      }

      ai_spawned.var_8046dccf = 1;
      ai_spawned thread function_bf606a73(self, instance);
      n_spawned++;

      if(n_spawned >= n_total) {
        break;
      }
    }

    if(i >= self.var_559503f1.size - 1) {
      i = 0;
    }

    waitframe(1);
  }

  self thread function_9b6490c4(instance);
}

function function_9b6490c4(instance) {
  instance endon(#"objective_ended");
  self endon(#"death", #"approach");
  self waittill(#"portal");
  instance.n_active = function_dae1a57b();
  instance.n_spawned = 0;

  while(true) {
    level flag::wait_till("spawn_zombies");

    if(instance.n_spawned < instance.n_active) {
      str_aitype = function_aece4588(level.var_b48509f9);

      if(namespace_7589cf5c::function_82e262cf(str_aitype)) {
        if(isDefined(instance.var_38c710c3)) {
          n_cooldown = namespace_7589cf5c::function_190c51a9();
          var_be32c966 = float(gettime()) / 1000 - instance.var_38c710c3;

          if(var_be32c966 < n_cooldown) {
            str_aitype = namespace_7589cf5c::function_b9e4c169();
          } else {
            instance.var_38c710c3 = undefined;
          }
        }

        if(instance.var_2133c784 >= instance.var_61c57c53 || instance.var_b803db9c >= instance.var_5de17ec9) {
          str_aitype = namespace_7589cf5c::function_b9e4c169();
        }
      }

      ai_spawned = namespace_85745671::function_9d3ad056(str_aitype, self.s_portal.origin + (randomintrange(-20, 20), randomintrange(-20, 20), 0), self.s_portal.angles, "payload_zombie");
      wait 0.1;

      if(isDefined(ai_spawned)) {
        ai_spawned.var_a950813d = 1;
        instance.n_spawned++;

        if(namespace_7589cf5c::function_82e262cf(ai_spawned.aitype)) {
          instance.var_38c710c3 = float(gettime()) / 1000;
          instance.var_2133c784++;
          instance.var_b803db9c++;
          ai_spawned callback::function_d8abfc3d(#"on_ai_killed", &function_c36cb7b1);
        }

        ai_spawned thread function_bf606a73(self, instance);
      }
    }

    wait 0.25;
  }
}

function zombie_death_watcher(params) {
  if(self.aitype === # "hash_7a8b592728eec95d" && !is_true(self.b_exploded)) {
    self.b_exploded = 1;

    if(isDefined(level.contentmanager.activeobjective.var_b8ca9d7)) {
      if(isDefined(self) && distance2dsquared(self.origin, level.contentmanager.activeobjective.var_b8ca9d7.origin) <= sqr(200)) {
        n_dmg = 50;
        level.contentmanager.activeobjective.var_b8ca9d7 dodamage(n_dmg, level.contentmanager.activeobjective.var_b8ca9d7.origin, self, undefined, undefined, "MOD_EXPLOSIVE");
      }
    }
  }

  if(isDefined(level.contentmanager.activeobjective.n_active) && level.contentmanager.activeobjective.n_active > 0) {
    level.contentmanager.activeobjective.n_active--;
  }
}

function function_dae1a57b() {
  n_players = getplayers().size;

  switch (n_players) {
    case 1:
      n_spawns = 4;
      break;
    case 2:
      n_spawns = 6;
      break;
    case 3:
      n_spawns = 9;
      break;
    case 4:
      n_spawns = 13;
      break;
    default:
      n_spawns = 8;
      break;
  }

  return n_spawns;
}

function function_ce92dcb0() {
  n_players = getplayers().size;

  switch (n_players) {
    case 1:
      n_spawns = 8;
      break;
    case 2:
      n_spawns = 12;
      break;
    case 3:
      n_spawns = 16;
      break;
    case 4:
      n_spawns = 20;
      break;
    default:
      n_spawns = 14;
      break;
  }

  return n_spawns;
}

function function_7db7fcd5(instance) {
  players = function_a1ef346b(undefined, self.origin, 300);

  foreach(player in players) {
    targetorigin = (player.origin[0], player.origin[1], self.origin[2]);
    var_a6470558 = vectornormalize(targetorigin - self.origin);
    player function_bc82f900("damage_heavy");
    player playerknockback(1);
    player applyknockback(100, var_a6470558);
    player playerknockback(0);
  }
}

function function_785ea4f4(instance) {
  self endon(#"death");
  objective_setinvisibletoall(self.n_objective_id);
  self ghost();
  wait 2;
  self notify(#"approach");

  if(isDefined(self.mdl_portal)) {
    self.mdl_portal clientfield::increment("" + # "portal_shockwave");
    self.mdl_portal clientfield::set("" + # "portal", 0);
  }

  wait 2.75;

  if(isDefined(self.var_43123efe)) {
    if(instance.variant === "payload_teleport" && isDefined(self.var_43123efe.var_5c6f6051)) {
      level thread function_ceab499d(self.var_43123efe.powerup_name, self.origin);
    }

    if(is_true(self.var_43123efe.var_2d1326e)) {
      self.var_43123efe notify(#"hash_52a1c0be67192d9b");
      self.var_43123efe deletedelay();
    } else {
      self.var_43123efe delete();
    }
  }

  self playrumbleonentity(#"sr_payload_portal_final_rumble");

  if(isDefined(self.mdl_portal)) {
    self.mdl_portal delete();
  }

  if(isDefined(self.var_3e5ed63d)) {
    self.var_3e5ed63d delete();
  }

  if(isDefined(self.var_edbf8a99)) {
    self.var_edbf8a99 delete();
  }

  foreach(player in getplayers()) {
    player.var_d23362c = 0;
    player clientfield::set_to_player("" + # "portal_blur", 0);
  }
}

function function_ceab499d(str_powerup, v_org) {
  mdl_powerup = zm_powerups::specific_powerup_drop(str_powerup, v_org);
}

function function_69c0c9b6() {
  self endon(#"death");
  self.allowdeath = 1;

  if(self.archetype === # "zombie") {
    gibserverutils::annihilate(self);
  }

  self kill(undefined, undefined, undefined, undefined, undefined, 1);
}

function function_cd8da208(var_b8ca9d7, instance) {
  self endon(#"death");
  var_b8ca9d7 endon(#"death");
  instance endon(#"objective_ended");

  if(math::cointoss()) {
    awareness::function_c241ef9a(self, var_b8ca9d7, 15);
    return;
  }

  self thread function_bf606a73(var_b8ca9d7, instance);
}

function function_bf606a73(var_b8ca9d7, instance) {
  self endon(#"death");
  var_b8ca9d7 endon(#"death");
  instance endon(#"objective_ended");
  self.str_move = "sprint";
  self callback::function_d8abfc3d(#"hash_4afe635f36531659", &function_fd68cae4);
  wait 0.1;

  while(true) {
    a_players = getplayers();
    player = awareness::function_d7fedde2(var_b8ca9d7);

    if(!isDefined(self.is_attacking) && isalive(self) && isalive(player)) {
      self.is_attacking = 1;
      awareness::function_c241ef9a(self, player, 16);
    }

    wait 15;
    self.is_attacking = undefined;
  }
}

function function_fd68cae4() {
  if(self.archetype == # "zombie") {
    if(level.var_b48509f9 < 5) {
      self namespace_85745671::function_9758722(self.str_move);
    }
  }
}

function function_9049ebf8(instance) {
  self endon(#"death", #"reached_end_node");
  instance endon(#"objective_ended");
  level waittill(#"timer_payload");

  if(is_true(self.var_a123c71)) {
    level thread namespace_7589cf5c::play_vo("objectivePayloadSuddenDeath");
  }

  while(is_true(self.var_a123c71)) {
    wait 0.1;
  }

  self thread function_dd677e5d();
  self notify(#"destruct");
  self setbrake(1);
  wait 2;
  self dodamage(self.health, self.origin);
}

function function_dd677e5d() {
  if(isDefined(self.mdl_portal)) {
    self.mdl_portal delete();
  }

  if(isDefined(self.var_3e5ed63d)) {
    self.var_3e5ed63d delete();
  }

  foreach(player in getplayers()) {
    player.var_d23362c = 0;
    player clientfield::set_to_player("" + # "portal_blur", 0);
  }
}

function function_fe857bf3(instance) {
  instance endon(#"objective_ended");
  self waittill(#"death");

  if(isDefined(self)) {
    self.var_a123c71 = 0;
  }

  if(isDefined(self)) {
    radiusdamage(self.origin, 1200, 1000, 500, self, "MOD_EXPLOSIVE");
  }

  if(instance flag::get(#"hash_12988a5a3e6a65d6")) {
    level.var_97e461d4 = undefined;
    instance flag::clear(#"hash_12988a5a3e6a65d6");
  }

  objective_manager::objective_ended(instance, 0);
}

function function_87de8025(instance) {
  instance waittill(#"objective_ended");

  if(instance.success) {
    self delete();
  }
}

function function_6ae999c2(instance) {
  self endon(#"death", #"destruct");
  instance endon(#"objective_ended");
  self.var_a123c71 = 0;
  self.var_f8edfabd = 0;
  self.var_f5d0e3f6 = 0;
  self.var_59078fae = 0;
  self.var_b591d382 = 0;
  self.var_ee53f643 = 0;
  self waittill(#"deployed");
  self thread function_1e88c470(instance);

  if(getplayers().size === 1) {
    var_2a9d371 = 5;
  } else {
    var_2a9d371 = 4;
  }

  while(true) {
    self.b_proximity = 0;
    self.n_players = 0;
    a_players = getplayers();

    foreach(player in a_players) {
      if(distancesquared(self.origin, player.origin) <= sqr(350) && !player laststand::player_is_in_laststand()) {
        player scoreevents::function_31553fb3();
        self.b_proximity = 1;
        self.n_players++;
      }
    }

    if(isDefined(instance.var_f16db373)) {
      if(distance2dsquared(instance.var_f16db373.origin, self.origin) <= sqr(300)) {
        self.b_proximity = 1;
      }
    }

    if(isDefined(self.mdl_portal)) {
      if(distance2dsquared(self.mdl_portal.origin, self.origin) <= sqr(300) && !self.var_ee53f643) {
        self.b_proximity = 1;
      }
    }

    n_speed = max(self.n_players + var_2a9d371, 6);
    wait 0.25;

    if(!self.b_proximity || is_true(self.abnormal_status.emped) || is_true(self.var_f5d0e3f6)) {
      self setspeed(0, 5, 3);
      self.var_a123c71 = 0;
      self setbrake(1);
      self vehicle::toggle_lights_group(4, 1);
      self clientfield::set("" + # "payload_running", 0);
      self notify(#"hash_734e3e2063a699a2");

      if(!isDefined(self.var_b79a8ac7) && !self.var_f8edfabd && !self.var_b591d382) {
        self thread function_fa1230e0(instance);
      }

      continue;
    }

    self notify(#"hash_76f907c580cdbbc6");
    self setspeed(n_speed, 5, 3);
    self.var_a123c71 = 1;
    self setbrake(0);
    self vehicle::toggle_lights_group(4, 0);
    self clientfield::set("" + # "payload_running", 1);
    self.var_a2c49add = undefined;
    self.var_f8edfabd = 0;
    namespace_85745671::cleanup_attackable(self);

    if(self.var_59078fae) {
      self.var_59078fae = 0;
      self connectpaths();
    }
  }
}

function function_fa1230e0(instance) {
  instance endon(#"objective_ended");
  self endon(#"hash_76f907c580cdbbc6", #"death");
  self.var_f8edfabd = 1;
  wait 1;
  self disconnectpaths();
  self.var_59078fae = 1;
  wait 1;
  slots = namespace_85745671::function_bdb2b85b(self, self.origin, self.angles, 64, 4, 300);

  if(!isDefined(slots) || slots.size <= 0) {
    self.var_f8edfabd = 0;
    return;
  }

  self.var_b79a8ac7 = {
    #var_f019ea1a: 1000, #slots: slots
  };
  level.attackables[level.attackables.size] = self;
  self.var_f8edfabd = 0;
}

function function_3ef1d58a(instance, n_path) {
  if(instance.variant === "payload_noteleport") {
    var_cdce8e6f = instance.contentgroups[#"hash_fc6148f0765e54b" + n_path][0];
  } else if(instance.variant === "payload_teleport") {
    var_cdce8e6f = instance.contentgroups[#"hash_87cb4370bdebb2a" + n_path][0];
  }

  if(isDefined(var_cdce8e6f.script_noteworthy)) {
    instance flag::set(#"hash_12988a5a3e6a65d6");
    level.var_97e461d4 = var_cdce8e6f.script_noteworthy;
  }
}

function function_49ae80f0(instance) {
  self notify("5f3bf21419e6a0a6");
  self endon("5f3bf21419e6a0a6");
  instance endon(#"objective_ended");
  self endon(#"hash_76f907c580cdbbc6", #"death");
  wait 20;
  a_s_pts = namespace_85745671::function_e4791424(self.origin, 24, 40, 1200, 1000);
  n_spawns = function_4bed5fd6();

  for(i = 0; i < n_spawns; i++) {
    level flag::wait_till("spawn_zombies");

    if(math::cointoss()) {
      str_aitype = # "hash_7a8b592728eec95d";
    } else if(level.var_b48509f9 > 2) {
      str_aitype = # "hash_46c917a1b5ed91e7";
    } else if(level.var_b48509f9 > 1) {
      str_aitype = # "hash_338eb4103e0ed797";
    } else {
      str_aitype = # "hash_7cba8a05511ceedf";
    }

    if(isDefined(a_s_pts[i])) {
      ai_spawned = namespace_85745671::function_9d3ad056(str_aitype, a_s_pts[i].origin, self.angles, "payload_zombie");
      wait 0.1;

      if(isDefined(ai_spawned)) {
        ai_spawned.var_a950813d = 1;
        instance.var_74ec00fb++;
        ai_spawned thread function_84d85877(instance);
        ai_spawned thread function_bf606a73(self, instance);
      }
    }
  }
}

function function_4bed5fd6() {
  switch (getplayers().size) {
    case 1:
      n_spawns = 8;
      break;
    case 2:
      n_spawns = 12;
      break;
    case 3:
      n_spawns = 16;
      break;
    case 4:
      n_spawns = 20;
      break;
  }

  return n_spawns;
}

function function_8469f022(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  var_ad5fcb11 = 0;

  while(true) {
    if(self.var_a123c71 == 1) {
      if(var_ad5fcb11 != 1) {
        self playSound(#"hash_432c591c600ef4d2");
        var_ad5fcb11 = 1;
      }
    } else if(var_ad5fcb11 != 0) {
      self playSound(#"hash_5d9bb1a3ab5cf792");
      var_ad5fcb11 = 0;
    }

    wait 0.25;
  }
}

function function_1e88c470(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");

  while(true) {
    if(!is_true(self.var_a123c71)) {
      self playSound(#"hash_52af5fa9a4db69a2");
    }

    wait 3;
  }
}

function function_9c54feb0(instance) {
  self.n_objective_id = zm_utility::function_f5a222a8(#"hash_33a2a5933ee65208", self);
  instance waittill(#"objective_ended");
  zm_utility::function_bc5a54a8(self.n_objective_id);
}

function payload_teleport(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  self.var_c57af231 = 0;

  while(true) {
    self waittill(#"reached_end_node");

    if(isDefined(self.mdl_portal)) {
      self.mdl_portal playrumblelooponentity(#"sr_payload_portal_rumble");
    }

    self.var_b591d382 = 1;
    self setbrake(1);
    self objective_manager::function_811514c3();

    if(isDefined(self.currentnode.script_string)) {
      self.var_6a4ec994++;
      function_3ef1d58a(instance, self.var_6a4ec994 + 1);
      var_b5ec4cd3 = getvehiclenode(self.currentnode.script_string, "targetname");
      var_b5ec4cd3.var_d5ebc20b = getvehiclenode(var_b5ec4cd3.script_string, "targetname");

      if(isDefined(var_b5ec4cd3)) {
        n_time = var_b5ec4cd3.script_int;
      }

      self ghost();

      if(isDefined(self.var_43123efe)) {
        if(is_true(self.var_43123efe.var_2d1326e)) {
          self.var_43123efe notify(#"hash_52a1c0be67192d9b");
          self.var_43123efe deletedelay();
        } else {
          self.var_43123efe delete();
        }
      }

      objective_setinvisibletoall(self.n_objective_id);
      wait 1;
      level thread namespace_7589cf5c::play_vo("objectivePayloadRiftCollapse");
      wait 1;

      if(isDefined(self.mdl_portal)) {
        self.mdl_portal clientfield::increment("" + # "portal_shockwave");
        self.mdl_portal clientfield::set("" + # "portal", 0);
      }

      wait 2.75;

      if(isDefined(self.mdl_portal)) {
        self.mdl_portal clientfield::set("" + # "payload_teleport", 1);
      }

      wait 0.1;
      self function_7db7fcd5(instance);

      if(isDefined(self.mdl_portal)) {
        self.mdl_portal stoprumble(#"sr_payload_portal_rumble");
        self.mdl_portal delete();
      }

      if(isDefined(self.var_edbf8a99)) {
        self.var_edbf8a99 notsolid();
      }

      self vehicle::get_off_path();
      waitframe(1);

      if(instance.targetname === "objective_golova_payload_teleport") {
        var_cdce8e6f = instance.contentgroups[#"hash_4aa151892b77e9c8"][0];

        if(isDefined(var_cdce8e6f.script_noteworthy)) {
          instance flag::set(#"hash_12988a5a3e6a65d6");
          level.var_97e461d4 = var_cdce8e6f.script_noteworthy;
        }
      }

      self function_42fbf5d9(instance, var_b5ec4cd3);
      wait 0.5;
      self notify(#"assault");
      self thread vehicle::go_path();
      self thread function_3c8781f3(instance);
      wait 2;

      if(isDefined(self.var_cb43e7ed)) {
        self.var_cb43e7ed clientfield::set("" + # "portal", 0);
        self.var_cb43e7ed delete();
      }

      self setbrake(0);

      while(true) {
        if(is_true(self.var_e0c43095)) {
          break;
        }

        if(!self.var_c57af231) {
          self.var_c57af231 = 1;

          while(!is_true(self.b_proximity)) {
            waitframe(1);
          }

          wait 0.5;
          level namespace_7589cf5c::play_vo("objectivePayloadReturned");
          self.var_e0c43095 = 1;
          break;
        }

        wait 0.1;
      }

      wait 0.5;
      level namespace_7589cf5c::play_vo("objectivePayloadReturnedResponse");
      self.var_b591d382 = 0;

      if(self.variant === "payload_noteleport") {
        self waittill(#"exam_done");
      }

      if(self.var_6a4ec994 > 1) {
        self.mdl_beam = util::spawn_model("tag_origin", var_b5ec4cd3.var_d5ebc20b.origin);
        self waittill(#"final_rift");

        if(isDefined(self.mdl_beam)) {
          wait 1.5;
          self.mdl_beam clientfield::set("" + # "payload_teleport", 2);
          self thread function_e0c5b0a4(instance);
        }
      }

      self.mdl_portal = util::spawn_model("tag_origin", var_b5ec4cd3.var_d5ebc20b.origin, (0, 90, 0));
      self.mdl_portal clientfield::set("" + # "portal", 1);
      self.mdl_portal thread function_fd3059d0(instance);

      if(isDefined(self.var_edbf8a99)) {
        self.var_edbf8a99 moveto(self.mdl_portal.origin, 0.05);
        self.var_edbf8a99 waittill(#"movedone");
        self.var_edbf8a99 solid();
      }

      continue;
    }

    self function_785ea4f4(instance);

    if(isDefined(self.health) && isDefined(self.max_health) && self.health / self.max_health >= 0.8) {
      level scoreevents::doscoreeventcallback("scoreEventSR", {
        #scoreevent: "escort_pristine_zm", #allplayers: 1
      });
    }

    instance thread function_28250c29();
    namespace_7589cf5c::function_3899cfea();
    objective_manager::objective_ended(instance);
    break;
  }
}

function function_e0c5b0a4(instance) {
  self endon(#"death");
  instance endon(#"objective_ended");
  wait 3;
  self notify(#"final_portal");
  self waittill(#"enter");

  if(isDefined(self.mdl_beam)) {
    self.mdl_beam clientfield::set("" + # "payload_teleport", 0);
  }
}

function function_3c8781f3(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(!self.var_a123c71) {
    objective_setinvisibletoall(self.n_objective_id);
    wait 0.5;
    objective_setvisibletoall(self.n_objective_id);
    wait 0.5;
  }

  objective_setvisibletoall(self.n_objective_id);
}

function function_fd3059d0(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    foreach(player in getplayers()) {
      if(isalive(player)) {
        if(distance2dsquared(self.origin, player.origin) <= sqr(120) && !is_true(player.var_d23362c)) {
          player dodamage(20, self.origin, self, self, undefined, "MOD_DEATH_CIRCLE");
          player clientfield::set_to_player("" + # "portal_blur", 1);
          player function_bc82f900("damage_heavy");
          player.var_d23362c = 1;
          continue;
        }

        if(distance2dsquared(self.origin, player.origin) <= sqr(150) && !is_true(player.var_d23362c)) {
          player dodamage(10, self.origin, self, self, undefined, "MOD_DEATH_CIRCLE");
          player clientfield::set_to_player("" + # "portal_blur", 1);
          player function_bc82f900("damage_heavy");
          player.var_d23362c = 1;
          continue;
        }

        if(distance2dsquared(self.origin, player.origin) <= sqr(180) && !is_true(player.var_d23362c)) {
          player dodamage(5, self.origin, self, self, undefined, "MOD_DEATH_CIRCLE");
          player clientfield::set_to_player("" + # "portal_blur", 1);
          player function_bc82f900("damage_light");
          player.var_d23362c = 1;
          continue;
        }

        if(is_true(player.var_d23362c)) {
          player.var_d23362c = 0;
          player clientfield::set_to_player("" + # "portal_blur", 0);
        }
      }
    }

    wait 1;
  }
}

function function_42fbf5d9(instance, var_f00d1e) {
  instance endon(#"objective_ended");
  self endon(#"death");
  self.var_a0bd9710 = util::spawn_model("tag_origin", self.origin, var_f00d1e.angles);
  self.var_a0bd9710 rotateto(var_f00d1e.angles + (randomintrange(200, 270), randomintrange(200, 270), randomintrange(200, 270)), 0.05);
  wait 0.1;
  self linkto(self.var_a0bd9710);
  wait 0.1;
  n_dist = distance(self.var_a0bd9710.origin, var_f00d1e.origin);
  n_time = n_dist / 1000;
  var_7fd007f9 = distance2d(self.var_a0bd9710.origin, var_f00d1e.origin) * 0.5;
  n_inc = int(n_dist);
  self show();
  objective_setvisibletoall(self.n_objective_id);
  self.var_a0bd9710 rotateto(var_f00d1e.angles, n_time + 6);
  self.var_a0bd9710 playrumbleonentity(#"hash_2d43d9987e4a73a8");
  self clientfield::set("" + # "teleport_trail", 1);
  level thread namespace_7589cf5c::play_vo("objectivePayloadRiftCollapseResponse");

  while(true) {
    var_ed0c1ff8 = distance2d(self.var_a0bd9710.origin, var_f00d1e.origin);

    if(var_ed0c1ff8 <= 100) {
      break;
    }

    v_dest = var_f00d1e.origin + (0, 0, n_inc);
    n_inc -= 30;

    if(v_dest[2] <= var_f00d1e.origin[2]) {
      break;
    }

    self.var_a0bd9710 moveto(v_dest, n_time);
    waitframe(1);
  }

  foreach(player in getplayers()) {
    player.var_d23362c = 0;
    player clientfield::set_to_player("" + # "portal_blur", 0);
  }

  n_dist = distance(self.var_a0bd9710.origin, var_f00d1e.origin);
  n_time = n_dist / 600;
  self.var_a0bd9710 moveto(var_f00d1e.origin + (0, 0, 40), n_time);
  self.var_a0bd9710 waittill(#"movedone");
  self clientfield::set("" + # "teleport_trail", 0);
  self.var_a0bd9710 playrumbleonentity(#"sr_transmitter_impact");
  self thread function_de22e1a0();
  self unlink();
  waitframe(1);
  self.angles = var_f00d1e.angles;
  self vehicle::get_on_path(var_f00d1e);
  self playSound(#"hash_3a33f6dc09073444");
  wait 0.5;

  if(self.var_6a4ec994 < 2) {
    self.var_43123efe = instance function_eb76d765();
  } else {
    self.var_43123efe = instance function_dc378d61();
  }

  wait 0.25;

  if(isDefined(self.var_43123efe)) {
    if(isDefined(self.var_43123efe.v_offset) && isDefined(self.var_43123efe.v_ang)) {
      self.var_43123efe linkto(self, "tag_cage_attach", self.var_43123efe.v_offset, self.var_43123efe.v_ang);
    } else {
      self.var_43123efe linkto(self, "tag_cage_attach");
    }
  }

  self.var_a0bd9710 delete();
}

function function_de22e1a0() {
  players = function_a1ef346b(undefined, self.origin, 500);

  foreach(player in players) {
    targetorigin = (player.origin[0], player.origin[1], self.origin[2]);
    var_a6470558 = vectornormalize(targetorigin - self.origin);
    player playerknockback(1);
    player applyknockback(100, var_a6470558);
    player playerknockback(0);
    player dodamage(100, self.origin);
  }
}

function function_4ebec20d(var_f00d1e) {
  self endon(#"death");

  if(!isDefined(self.var_cb43e7ed)) {
    self.var_cb43e7ed = util::spawn_model("tag_origin", var_f00d1e.origin, (0, 90, 0));
    self.var_cb43e7ed clientfield::set("payload_teleport", 2);
  }
}

function function_6c09e96b(instance, n_time) {
  instance endon(#"objective_ended");
  self endon(#"death");
  self waittilltimeout(8, #"hash_76f907c580cdbbc6");
  instance thread objective_manager::start_timer(n_time, "payload");
}

function function_eb89f65f(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");
  self vehicle::lights_off();
  self waittill(#"payload_start");
  self vehicle::toggle_sounds(1);
  self vehicle::lights_on();
}

function function_79ae8e99(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    a_zombies = function_a38db454(self.origin, 200);

    foreach(zombie in a_zombies) {
      if(zombie.archetype === # "zombie" && is_true(self.var_a123c71) && !is_true(zombie.knockdown)) {
        if(distance2dsquared(self.origin, zombie.origin) > sqr(60)) {
          continue;
        }

        zombie dodamage(50, self.origin, self, undefined, undefined, "MOD_CRUSH");
        zombie.knockdown = 1;
        zombie.knockdown_type = "knockdown_shoved";
        var_7d6a995e = self.origin - zombie.origin;
        var_1040735c = vectornormalize((var_7d6a995e[0], var_7d6a995e[1], 0));
        zombie_forward = anglesToForward(zombie.angles);
        zombie_forward_2d = vectornormalize((zombie_forward[0], zombie_forward[1], 0));
        zombie_right = anglestoright(zombie.angles);
        zombie_right_2d = vectornormalize((zombie_right[0], zombie_right[1], 0));
        dot = vectordot(var_1040735c, zombie_forward_2d);

        if(dot >= 0.5) {
          zombie.knockdown_direction = "front";
          zombie.getup_direction = "getup_back";
          zombie thread function_c93a6362(self);
        } else if(dot < 0.5 && dot > -0.5) {
          dot = vectordot(var_1040735c, zombie_right_2d);

          if(dot > 0) {
            zombie.knockdown_direction = "right";

            if(math::cointoss()) {
              zombie.getup_direction = "getup_back";
            } else {
              zombie.getup_direction = "getup_belly";
            }
          } else {
            zombie.knockdown_direction = "left";
            zombie.getup_direction = "getup_belly";
          }
        } else {
          zombie.knockdown_direction = "back";
          zombie.getup_direction = "getup_belly";
        }

        continue;
      }

      if(zombie.archetype === # "zombie" && is_true(self.var_a123c71) && is_true(zombie.knockdown)) {
        if(distance2dsquared(self.origin, zombie.origin) > sqr(60)) {
          continue;
        }

        zombie thread function_c93a6362(self);
      }
    }

    wait 0.1;
  }
}

function function_c93a6362(var_b8ca9d7) {
  self endon(#"death");
  var_b8ca9d7 endon(#"death");

  if(isDefined(self.knockdown_direction) && isalive(self)) {
    self thread function_1b4b0c63(var_b8ca9d7);
  }
}

function function_1b4b0c63(var_b8ca9d7) {
  self endon(#"death");
  var_b8ca9d7 endon(#"death");
  wait 0.75;
  v_forward = var_b8ca9d7.origin + anglesToForward(var_b8ca9d7.angles) * 60;

  if(distance2dsquared(var_b8ca9d7.origin, self.origin) < sqr(70)) {
    gibserverutils::annihilate(self);

    if(isalive(self)) {
      if(zm_utility::is_magic_bullet_shield_enabled(self)) {
        self util::stop_magic_bullet_shield();
      }

      if(isalive(self)) {
        self kill();
      }
    }

    return;
  }

  self.knockdown_direction = undefined;
}

function function_9bf6c44a() {
  self.a_s_blockers = self.contentgroups[#"zombie_blocker"];
  self.a_mdl_blockers = [];

  foreach(s_blocker in self.a_s_blockers) {
    self.a_mdl_blockers[self.a_mdl_blockers.size] = content_manager::spawn_script_model(s_blocker, s_blocker.model, 1);
  }

  foreach(mdl_blocker in self.a_mdl_blockers) {
    mdl_blocker ghost();
  }

  self waittill(#"objective_ended");

  foreach(mdl_blocker in self.a_mdl_blockers) {
    mdl_blocker connectpaths();
    wait 0.1;
    mdl_blocker delete();
  }
}

function function_aece4588(var_3afe334f) {
  switch (var_3afe334f) {
    case 1:
      var_e7a1cbae = # "objective_payload_ailist_1";
      break;
    case 2:
      var_e7a1cbae = # "objective_payload_ailist_2";
      break;
    case 3:
      var_e7a1cbae = # "objective_payload_ailist_3";
      break;
    case 4:
      var_e7a1cbae = # "objective_payload_ailist_4";
      break;
    case 5:
      var_e7a1cbae = # "objective_payload_ailist_5";
      break;
    case 6:
      var_e7a1cbae = # "objective_payload_ailist_6";
      break;
    case 7:
      var_e7a1cbae = # "objective_payload_ailist_7";
      break;
    default:
      var_e7a1cbae = # "objective_payload_ailist_8";
      break;
  }

  var_6017f33e = namespace_679a22ba::function_ca209564(var_e7a1cbae);
  return var_6017f33e.aitype_name;
}

function function_89951438(instance) {
  instance endon(#"objective_ended");
  self endon(#"death");

  while(true) {
    if(isDefined(self)) {
      a_vehicles = getentitiesinradius(self.origin, 250, 14);

      foreach(vh in a_vehicles) {
        if(isDefined(vh)) {
          vh thread zm_utility::function_78e620d();
        }
      }
    }

    wait 0.25;
  }
}